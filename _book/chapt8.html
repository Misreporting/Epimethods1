<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Epidemiology Methods lecture notes - 10&nbsp; Confounding and linear regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./chapt9.html" rel="next">
<link href="./chapt7.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Confounding and linear regression</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Epidemiology Methods lecture notes</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction: Types of studies</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chaptA.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapt1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data displays</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapt2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Identifying research questions and data sources</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapt3.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Testing hypotheses</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapt4.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Associations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapt5.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Causality vs association</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapt6.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Excess risk</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapt7.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Measurement error and screening</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapt8.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Confounding and linear regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapt9.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Confounding and causal graphs</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapt10.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Ecological studies</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapt11.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Example data analysis in YRBS</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapt12.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Survey data analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapt13.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Randomized experiments and quasi-experiments</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapt14.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Cohort studies</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapt15.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Case-control studies</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Summary</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#confounding-definition" id="toc-confounding-definition" class="nav-link active" data-scroll-target="#confounding-definition"><span class="toc-section-number">10.1</span>  Confounding definition</a></li>
  <li><a href="#effect-modification" id="toc-effect-modification" class="nav-link" data-scroll-target="#effect-modification"><span class="toc-section-number">10.2</span>  Effect modification</a>
  <ul class="collapse">
  <li><a href="#confounding-example" id="toc-confounding-example" class="nav-link" data-scroll-target="#confounding-example"><span class="toc-section-number">10.2.1</span>  Confounding example</a></li>
  <li><a href="#confounding-in-a-case-control-study" id="toc-confounding-in-a-case-control-study" class="nav-link" data-scroll-target="#confounding-in-a-case-control-study"><span class="toc-section-number">10.2.2</span>  Confounding in a case-control study</a></li>
  <li><a href="#confounding-in-a-cohort-study" id="toc-confounding-in-a-cohort-study" class="nav-link" data-scroll-target="#confounding-in-a-cohort-study"><span class="toc-section-number">10.2.3</span>  Confounding in a cohort study</a></li>
  <li><a href="#addressing-potential-confounding-through-rate-adjustment" id="toc-addressing-potential-confounding-through-rate-adjustment" class="nav-link" data-scroll-target="#addressing-potential-confounding-through-rate-adjustment"><span class="toc-section-number">10.2.4</span>  Addressing potential confounding through rate adjustment</a></li>
  <li><a href="#addressing-confounding-through-multivariate-regression" id="toc-addressing-confounding-through-multivariate-regression" class="nav-link" data-scroll-target="#addressing-confounding-through-multivariate-regression"><span class="toc-section-number">10.2.5</span>  Addressing confounding through multivariate regression</a></li>
  </ul></li>
  <li><a href="#identifying-effect-modification-using-multivariate-regression" id="toc-identifying-effect-modification-using-multivariate-regression" class="nav-link" data-scroll-target="#identifying-effect-modification-using-multivariate-regression"><span class="toc-section-number">10.3</span>  Identifying effect modification using multivariate regression</a></li>
  <li><a href="#assumptions-of-regression" id="toc-assumptions-of-regression" class="nav-link" data-scroll-target="#assumptions-of-regression"><span class="toc-section-number">10.4</span>  Assumptions of regression</a>
  <ul class="collapse">
  <li><a href="#weaknesses-of-multivariate-regression" id="toc-weaknesses-of-multivariate-regression" class="nav-link" data-scroll-target="#weaknesses-of-multivariate-regression"><span class="toc-section-number">10.4.1</span>  Weaknesses of multivariate regression</a></li>
  </ul></li>
  <li><a href="#analyzing-potential-confounding-and-effect-modification-in-r" id="toc-analyzing-potential-confounding-and-effect-modification-in-r" class="nav-link" data-scroll-target="#analyzing-potential-confounding-and-effect-modification-in-r"><span class="toc-section-number">10.5</span>  Analyzing potential confounding and effect modification in R</a>
  <ul class="collapse">
  <li><a href="#heritability-of-height" id="toc-heritability-of-height" class="nav-link" data-scroll-target="#heritability-of-height"><span class="toc-section-number">10.5.1</span>  Heritability of height</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Confounding and linear regression</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="confounding-definition" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="confounding-definition"><span class="header-section-number">10.1</span> Confounding definition</h2>
<p>Confounders must be associated with both the exposure and the disease, and generally come before both exposure and disease. Confounders may explain all or part of an observed relationship between exposure and disease.</p>
<p>A factor that comes after the exposure is often not a confounder. It’s an intermediate variable, and controlling for it will introduce bias.</p>
<p>A confounder is: 1. associated with disease among non-exposed 2. associated with exposure 3. not intermediate between exposure and outcome</p>
<p>Simpson’s paradox: type of confounding, where the effect reverses after stratification.</p>
</section>
<section id="effect-modification" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="effect-modification"><span class="header-section-number">10.2</span> Effect modification</h2>
<p>An effect modifier is a factor that changes the relationship between a predictor and an outcome. For example, if smoking is more dangerous for men than women for some health outcome, then gender is an effect modifier of the relationship between smoking and that health outcome.</p>
<p>Addressing confounding through stratification</p>
<p>If effect estimate changes after stratifying on a potential confounder, then confounding is present.</p>
<p>A rule of thumb is that if the effect estimate changes by 10%, the crude estimate is confounded, and the adjusted values are more appropriate to present. We already saw one example with the Berkeley admissions data.</p>
<table class="table">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Men applicants</th>
<th style="text-align: left;">Men admitted</th>
<th style="text-align: left;"></th>
<th style="text-align: left;">Women applicants</th>
<th style="text-align: left;">Women admitted</th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Arts</td>
<td style="text-align: left;">4100</td>
<td style="text-align: left;">1300</td>
<td style="text-align: left;">32%</td>
<td style="text-align: left;">8250</td>
<td style="text-align: left;">3150</td>
<td style="text-align: left;">38%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sciences</td>
<td style="text-align: left;">8200</td>
<td style="text-align: left;">5100</td>
<td style="text-align: left;">62%</td>
<td style="text-align: left;">2900</td>
<td style="text-align: left;">1900</td>
<td style="text-align: left;">66%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total</td>
<td style="text-align: left;">12300</td>
<td style="text-align: left;">6400</td>
<td style="text-align: left;">52%</td>
<td style="text-align: left;">11150</td>
<td style="text-align: left;">5050</td>
<td style="text-align: left;">45%</td>
</tr>
</tbody>
</table>
<p>Note that the 10% rule of thumb is just a rule of thumb, and it doesn’t imply confunding, nor does it imply whether a term should be in a regression or not.</p>
<section id="confounding-example" class="level3" data-number="10.2.1">
<h3 data-number="10.2.1" class="anchored" data-anchor-id="confounding-example"><span class="header-section-number">10.2.1</span> Confounding example</h3>
</section>
<section id="confounding-in-a-case-control-study" class="level3" data-number="10.2.2">
<h3 data-number="10.2.2" class="anchored" data-anchor-id="confounding-in-a-case-control-study"><span class="header-section-number">10.2.2</span> Confounding in a case-control study</h3>
</section>
<section id="confounding-in-a-cohort-study" class="level3" data-number="10.2.3">
<h3 data-number="10.2.3" class="anchored" data-anchor-id="confounding-in-a-cohort-study"><span class="header-section-number">10.2.3</span> Confounding in a cohort study</h3>
</section>
<section id="addressing-potential-confounding-through-rate-adjustment" class="level3" data-number="10.2.4">
<h3 data-number="10.2.4" class="anchored" data-anchor-id="addressing-potential-confounding-through-rate-adjustment"><span class="header-section-number">10.2.4</span> Addressing potential confounding through rate adjustment</h3>
<p>Rate adjustment is a method of adjustment on a small number of categorical factors. Two groups may have different age distributions. Can weight communities by age composition of a reference group, to make the rates comparable.</p>
</section>
<section id="addressing-confounding-through-multivariate-regression" class="level3" data-number="10.2.5">
<h3 data-number="10.2.5" class="anchored" data-anchor-id="addressing-confounding-through-multivariate-regression"><span class="header-section-number">10.2.5</span> Addressing confounding through multivariate regression</h3>
<p>Often multiple factors are potential confounders, and some confounders are continuous. Discretization of continuous factors into a small number of categories allows residual confounding. Multivariate regression can reduce confounding by many factors simultaneously. The coefficients can all be described as adjusted for all of the covariates included in the regression.</p>
<table class="table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Outcome</th>
<th style="text-align: left;">Regression method</th>
<th style="text-align: left;">Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Continuous</td>
<td style="text-align: left;">Linear regression</td>
<td style="text-align: left;">Increase of outcome associated with one unit increase in the exposure</td>
</tr>
<tr class="even">
<td style="text-align: left;">Count</td>
<td style="text-align: left;">Poisson regression</td>
<td style="text-align: left;">Incidence rate ratio (longitudinal data) or prevalence ratio (cross-sectional data)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Binary</td>
<td style="text-align: left;">Poisson regression</td>
<td style="text-align: left;">Incidence rate ratio (longitudinal data) or prevalence ratio (cross-sectional data)</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Logistic regression</td>
<td style="text-align: left;">odds ratio</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Linear probability model</td>
<td style="text-align: left;">Percentage point difference in probability of outcome associated with one unit increase in exposure</td>
</tr>
<tr class="even">
<td style="text-align: left;">Proportions</td>
<td style="text-align: left;">Logistic regression</td>
<td style="text-align: left;">odds ratio</td>
</tr>
</tbody>
</table>
<p>Note: log = ln = natural log.</p>
<p>For the above example of potential confounding by age, one could use a logistic regression with outcome the proportion of people with the disease and use age as a predictor. The coefficient on age would tell us if there was a difference in disease by age.</p>
</section>
</section>
<section id="identifying-effect-modification-using-multivariate-regression" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="identifying-effect-modification-using-multivariate-regression"><span class="header-section-number">10.3</span> Identifying effect modification using multivariate regression</h2>
<p>Multivariate regression also allows testing for effect modification. Include an interaction term in the regression that is the product of the factors where there may be effect modification. It’s easier to identify graphically. This data comes from a review of chocolate bars in Consumer Reports: price, rating by Consumer Reports raters, and type of chocolate (milk or 70% cacao dark.)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'mosaic':
  method                           from   
  fortify.SpatialPolygonsDataFrame ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
The 'mosaic' package masks several functions from core packages in order to add 
additional features.  The original behavior of these functions should not be affected by this.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'mosaic'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    count, do, tally</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:Matrix':

    mean</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    stat</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    binom.test, cor, cor.test, cov, fivenum, IQR, median, prop.test,
    quantile, sd, t.test, var</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    max, mean, min, prod, range, sample, sum</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>chocolate<span class="ot">=</span><span class="fu">read.csv</span>(<span class="st">"chocolate-ratings-consumer-reports.csv"</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(rating <span class="sc">~</span> price, <span class="at">data=</span>chocolate, <span class="at">auto.key=</span>T,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="at">type=</span><span class="fu">c</span>(<span class="st">"p"</span>, <span class="st">"r"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="chapt8_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(rating <span class="sc">~</span> price, <span class="at">data=</span>chocolate, <span class="at">group=</span>type, <span class="at">auto.key=</span>T,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="at">type=</span><span class="fu">c</span>(<span class="st">"p"</span>, <span class="st">"r"</span>), <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="chapt8_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Which of these plots shows effect modification? How can you tell?</p>
<p>What do we see if we try a regression?</p>
</section>
<section id="assumptions-of-regression" class="level2" data-number="10.4">
<h2 data-number="10.4" class="anchored" data-anchor-id="assumptions-of-regression"><span class="header-section-number">10.4</span> Assumptions of regression</h2>
<p>Regression makes the following assumptions: 1. Linearity: The plot of response means (outcome) against the explanatory variable (pre- dictor) is a straight line. 2. Constant variance: The spread of the responses around the straight line is the same at all levels of the explanatory variable. Economists call this “homoscedasticity”. The opposite of homoscedasticity is heteroscedasticity. (Economists call statistics “econometrics” so clearly they just make up their own words.) 3. Normality: The subpopulations of responses around the straight line is the same at all levels of the explanatory variable. 4. Independence: The location of any outcome in relation to its mean cannot be predicted from knowledge of where other outcomes are in relation to their means, either fully or partially. Further, the location of any outcome in relation to its mean cannot be predicted from knowledge of the explanatory variable values. When these assumptions are violated, linear regression results may be inaccurate or mis- leading. 1. Violations of Linearity: Linearity could be violated either if the points form a curved line throughout the range of the predictors, or if there are enough outliers to change the direction of the line. Estimated means and predictions may be biased. 2. Non-constant variance: If there is non-constant variance, standard errors, signfiicance tests, and confidence intervals may be inaccurate. 3. Violations of normality: Usually does not threaten the validity of estimates of coefficients and their standard errors because the sampling distribution of estimates is normal re- gardless of the distribution of the population. With small samples that contain outliers, violations of normality can bias estimates of coefficients and standard errors.</p>
<ol start="4" type="1">
<li>Lack of independence: Lack of independence doesn’t bias estimates of coefficients, but it harms standard errors. Serial effects — where one observation relies on the observation before it — require models designed especially for this situation.</li>
</ol>
<p>Create plots</p>
<div class="cell">

</div>
<ol type="1">
<li><p>Best case scenario: standard regression (lm command in R) is perfect because the means are in a straight line and the standard deviation is approximately equal.</p></li>
<li><p>Means are curved — with a sharp increase at the beginning and reduced slope as X increases — and the standard deviations are about equal. This could occur in a case where there are reduced marginal effects as a predictor increases. Transforming X may make the means linear. Taking the log of X may help. Then do regression.</p></li>
<li><p>Means are curved in an inverted U shape, and the standard deviations are about equal. This could occur in a case where an outcome peaks at a certain ideal value of a predictor and then decreases again. Including a term with X2 will account for this effect. Then use regression.</p></li>
<li><p>Means are curved upwards, with slow increases in outcome for low values of the predictor, and increasing more sharply. Also, standard deviations increase with increasing values of the predictor. Transform Y (e.g., take the log of Y, square root of Y, or recriprocal of Y.) Plot again and evaluate whether this fixes the problem, and then use regression.</p></li>
<li><p>The means increase in a straight line and the standard deviations are about equal, but the distributions around the line are skewed. There is nothing to do about this problem, except to do regresison and report the skewness.</p></li>
<li><p>The means are a straight line, but the standard deviations are increasing as X increases. Regression gives reasonable estimates for the coefficients, but the standard errors are biased. Use weighted regression, which will be taught later.</p></li>
</ol>
<section id="weaknesses-of-multivariate-regression" class="level3" data-number="10.4.1">
<h3 data-number="10.4.1" class="anchored" data-anchor-id="weaknesses-of-multivariate-regression"><span class="header-section-number">10.4.1</span> Weaknesses of multivariate regression</h3>
<p>Regression should never be the first step in data analysis. Data analysis should always begin with univariate and bivariate analysis, preferably plots. Recall Anscombe’s plots: 4 different plots with exactly the same numerical summaries, including regression line. Multivariate regression relies on assumptions that are often not true. Multivariate regression requires that relationships between predictor and outcome be close to linear or log-linear. If a relationship between predictor and outcome is exponential, there will still be residual confounding after multivariate regression.</p>
</section>
</section>
<section id="analyzing-potential-confounding-and-effect-modification-in-r" class="level2" data-number="10.5">
<h2 data-number="10.5" class="anchored" data-anchor-id="analyzing-potential-confounding-and-effect-modification-in-r"><span class="header-section-number">10.5</span> Analyzing potential confounding and effect modification in R</h2>
<p>This example will demonstrate how to predict height from simple inputs, and demonstrates effect modification. Confounding isn’t particularly an issue because the inputs are obvious: parents’ heights and children’s sex.</p>
<section id="heritability-of-height" class="level3" data-number="10.5.1">
<h3 data-number="10.5.1" class="anchored" data-anchor-id="heritability-of-height"><span class="header-section-number">10.5.1</span> Heritability of height</h3>
<p>A famous regression dataset is from Francis Galton — heights of adults and their parents — which is in the mosaic package. This analysis involves simple prediction of an outcome (depen- dent variable) from predictor variables (independent variables.) The data has been cleaned of non-numeric entries for height such as “tall”, “short”, “idiotic”, and “deformed.”</p>
<p>Source: “Transmuting” women into men: Galton’s family data on human stature. (2004) The American Statistician, 58(3):237–243.</p>
<p>We can start out by looking at the distribution of (adult) children’s heights. Generally, we want outcomes of regressions to be normally distributed, or at least symmetrical. Do they look normally distributed? Symmetrical?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span>(<span class="sc">~</span>height, <span class="at">data=</span>Galton)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="chapt8_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span>(<span class="sc">~</span>height <span class="sc">|</span> sex, <span class="at">data=</span>Galton, <span class="at">auto.key=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="chapt8_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can also get a sense for which heights are typical for each group: males, females, mothers, and fathers. Do the children seem to be taller than their parents, on average?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">favstats</span>(<span class="sc">~</span>height, <span class="at">groups=</span>sex, <span class="at">data=</span>Galton)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  sex min   Q1 median   Q3  max     mean       sd   n missing
1   F  56 62.5   64.0 65.5 70.5 64.11016 2.370320 433       0
2   M  60 67.5   69.2 71.0 79.0 69.22882 2.631594 465       0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">favstats</span>(<span class="sc">~</span>father, <span class="at">data=</span>Galton)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> min Q1 median Q3  max     mean       sd   n missing
  62 68     69 71 78.5 69.23285 2.470256 898       0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">favstats</span>(<span class="sc">~</span>mother, <span class="at">data=</span>Galton)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> min Q1 median   Q3  max     mean       sd   n missing
  58 63     64 65.5 70.5 64.08441 2.307025 898       0</code></pre>
</div>
</div>
<p>How are children’s heights related to parents’ heights? Is the relationship different for male and female children?</p>
<p>Look first at plots.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(height <span class="sc">~</span> father, <span class="at">groups=</span>sex, <span class="at">type=</span><span class="fu">c</span>(<span class="st">"p"</span>, <span class="st">"r"</span>), <span class="at">auto.key=</span>T, <span class="at">data=</span>Galton)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="chapt8_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(height <span class="sc">~</span> mother, <span class="at">groups=</span>sex, <span class="at">type=</span><span class="fu">c</span>(<span class="st">"p"</span>, <span class="st">"r"</span>), <span class="at">auto.key=</span>T, <span class="at">data=</span>Galton)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="chapt8_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We have the concept of regression towards the mean: the children of exceptionally tall or exceptionally short parents will tend to be closer to average height. Do we see regression to the mean in this dataset? How could you tell from these plots? We can do regression analysis using this data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>model1<span class="ot">=</span><span class="fu">lm</span>(height <span class="sc">~</span> father <span class="sc">+</span> mother <span class="sc">+</span> sex, <span class="at">data=</span>Galton)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = height ~ father + mother + sex, data = Galton)

Residuals:
   Min     1Q Median     3Q    Max 
-9.523 -1.440  0.117  1.473  9.114 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 15.34476    2.74696   5.586 3.08e-08 ***
father       0.40598    0.02921  13.900  &lt; 2e-16 ***
mother       0.32150    0.03128  10.277  &lt; 2e-16 ***
sexM         5.22595    0.14401  36.289  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.154 on 894 degrees of freedom
Multiple R-squared:  0.6397,    Adjusted R-squared:  0.6385 
F-statistic:   529 on 3 and 894 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>What does each component mean? Intercept Father Mother Sex R-squared F-statistic Degrees of freedom Residual standard error Is the intercept meaningful? If not, how can we transform the variables so that the intercept becomes meaningful?</p>
<p>Does the relationship between parents’ heights differ for males and females? How can you tell?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>model1b<span class="ot">=</span><span class="fu">lm</span>(height <span class="sc">~</span> father <span class="sc">+</span> mother <span class="sc">+</span> sex <span class="sc">+</span> father<span class="sc">*</span>sex, <span class="at">data=</span>Galton)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = height ~ father + mother + sex + father * sex, data = Galton)

Residuals:
    Min      1Q  Median      3Q     Max 
-9.5248 -1.4463  0.1139  1.4718  9.1080 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 15.76019    3.33887   4.720 2.73e-06 ***
father       0.40023    0.03927  10.192  &lt; 2e-16 ***
mother       0.32123    0.03132  10.256  &lt; 2e-16 ***
sexM         4.33631    4.06250   1.067    0.286    
father:sexM  0.01285    0.05864   0.219    0.827    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.155 on 893 degrees of freedom
Multiple R-squared:  0.6397,    Adjusted R-squared:  0.6381 
F-statistic: 396.4 on 4 and 893 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>We can also explore further and consider two separate models: one for males, and one for females. Do males inherit their height from their fathers, or from both parents? Likewise, for females?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>model1.m<span class="ot">=</span><span class="fu">lm</span>(height <span class="sc">~</span> father, <span class="at">data=</span><span class="fu">subset</span>(Galton, sex<span class="sc">==</span><span class="st">"M"</span>))</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1.m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = height ~ father, data = subset(Galton, sex == "M"))

Residuals:
    Min      1Q  Median      3Q     Max 
-9.3774 -1.4968  0.0181  1.6375  9.3987 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 38.25891    3.38663   11.30   &lt;2e-16 ***
father       0.44775    0.04894    9.15   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.424 on 463 degrees of freedom
Multiple R-squared:  0.1531,    Adjusted R-squared:  0.1513 
F-statistic: 83.72 on 1 and 463 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>model2.m<span class="ot">=</span><span class="fu">lm</span>(height <span class="sc">~</span> father <span class="sc">+</span> mother, <span class="at">data=</span><span class="fu">subset</span>(Galton, sex<span class="sc">==</span><span class="st">"M"</span>))</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2.m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = height ~ father + mother, data = subset(Galton, 
    sex == "M"))

Residuals:
    Min      1Q  Median      3Q     Max 
-9.5305 -1.5683  0.2141  1.5183  9.0968 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 19.39988    4.13310   4.694 3.54e-06 ***
father       0.41175    0.04668   8.820  &lt; 2e-16 ***
mother       0.33355    0.04600   7.252 1.74e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.3 on 462 degrees of freedom
Multiple R-squared:  0.2397,    Adjusted R-squared:  0.2364 
F-statistic: 72.82 on 2 and 462 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>model1.f<span class="ot">=</span><span class="fu">lm</span>(height <span class="sc">~</span> mother, <span class="at">data=</span><span class="fu">subset</span>(Galton, sex<span class="sc">==</span><span class="st">"F"</span>))</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1.f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = height ~ mother, data = subset(Galton, sex == "F"))

Residuals:
    Min      1Q  Median      3Q     Max 
-6.8814 -1.5446  0.0983  1.4452  6.7717 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 43.15546    3.05709  14.117  &lt; 2e-16 ***
mother       0.32655    0.04761   6.859 2.42e-11 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.253 on 431 degrees of freedom
Multiple R-squared:  0.09841,   Adjusted R-squared:  0.09631 
F-statistic: 47.04 on 1 and 431 DF,  p-value: 2.421e-11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>model2.f<span class="ot">=</span><span class="fu">lm</span>(height <span class="sc">~</span> mother <span class="sc">+</span> father, <span class="at">data=</span><span class="fu">subset</span>(Galton, sex<span class="sc">==</span><span class="st">"F"</span>))</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2.f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = height ~ mother + father, data = subset(Galton, 
    sex == "F"))

Residuals:
    Min      1Q  Median      3Q     Max 
-6.3064 -1.3497  0.0261  1.4154  5.6684 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 16.61023    3.61648   4.593 5.75e-06 ***
mother       0.30746    0.04211   7.301 1.39e-12 ***
father       0.40072    0.03629  11.041  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.991 on 430 degrees of freedom
Multiple R-squared:  0.2975,    Adjusted R-squared:  0.2943 
F-statistic: 91.07 on 2 and 430 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Does the number of kids matter? Does the number of kids matter differently for males or for females?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>model2a<span class="ot">=</span><span class="fu">lm</span>(height <span class="sc">~</span> father <span class="sc">+</span> mother <span class="sc">+</span> sex <span class="sc">+</span> nkids, <span class="at">data=</span>Galton)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = height ~ father + mother + sex + nkids, data = Galton)

Residuals:
    Min      1Q  Median      3Q     Max 
-9.4748 -1.4500  0.0889  1.4716  9.1656 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 16.18771    2.79387   5.794 9.52e-09 ***
father       0.39831    0.02957  13.472  &lt; 2e-16 ***
mother       0.32096    0.03126  10.269  &lt; 2e-16 ***
sexM         5.20995    0.14422  36.125  &lt; 2e-16 ***
nkids       -0.04382    0.02718  -1.612    0.107    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.152 on 893 degrees of freedom
Multiple R-squared:  0.6407,    Adjusted R-squared:  0.6391 
F-statistic: 398.1 on 4 and 893 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>model2<span class="ot">=</span><span class="fu">lm</span>(height <span class="sc">~</span> father <span class="sc">+</span> mother <span class="sc">+</span> sex <span class="sc">+</span> nkids<span class="sc">*</span>sex, <span class="at">data=</span>Galton)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = height ~ father + mother + sex + nkids * sex, data = Galton)

Residuals:
   Min     1Q Median     3Q    Max 
-9.440 -1.441  0.083  1.452  9.198 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 15.718028   2.815112   5.583 3.13e-08 ***
father       0.401301   0.029640  13.539  &lt; 2e-16 ***
mother       0.321472   0.031245  10.289  &lt; 2e-16 ***
sexM         5.648164   0.360889  15.651  &lt; 2e-16 ***
nkids       -0.007547   0.038574  -0.196    0.845    
sexM:nkids  -0.071233   0.053780  -1.325    0.186    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.151 on 892 degrees of freedom
Multiple R-squared:  0.6414,    Adjusted R-squared:  0.6394 
F-statistic: 319.1 on 5 and 892 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./chapt7.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Measurement error and screening</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./chapt9.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Confounding and causal graphs</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>