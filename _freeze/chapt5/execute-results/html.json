{
  "hash": "771613f51549a40c5f15c48751f18354",
  "result": {
    "markdown": "# Causality vs association\n\nRemember our example of John Snow's investigation of cholera from last time.\n\nIn 1855, John Snow made the following cross-tabulation showing the rate of cholera among customers of 2 different London water providers. In 1852, Lambeth changed its intake pipe on the Thames to be upstream to avoid sewage contamination of the water. Southwark and Vauxhall kept the same intake pipe. John Snow evaluated whether there were any systematic differences between houses getting water from one company versus the other.\n\n\"The mixing of the \\[water\\] supply is of the most intimate kind. The pipes of each Company go down all the streets, and into nearly all the courts and alleys. A few houses are supplied by one Company and a few by the other, according to the decision of the owner or occupier at the time when the Water Companies were in active competition. In many cases, a single house has a supply different from that on either side. Each company supplies both rich and poor, both large houses and small; there is no difference either in the condition or occupation of the persons receiving the water of the different Companies. ... It is obvious that no experiment could have been devised which would more thoroughly test the effect of water supply on the progress of cholera than this.... \\[The new intake pipe\\] divided into two groups without their choice, and, in most cases, without their knowledge; one group being supplied with water containing the sewage of London, and, amongst it, whatever might have come from the cholera patients, the other group having water quite free from such impurity.\" (John Snow, 1855, On the Mode of Communication of Cholera London: John Churchill, 2nd edition. Reprinted in Snow on Cholera, London: Humphrey Milford; Oxford University Press, 1965)\n\n| Company                | Number of houses | Cholera deaths | Death rate per 10,000 |\n|:------------------|:-----------------|:-----------------|:-----------------|\n| Southwark and Vauxhall | 40,046           | 1263           | 315                   |\n| Lambeth                | 26,107           | 98             | 37                    |\n\nDid John Snow demonstrate causality? Did he demonstrate association? Something in between?\n\n## Philosophical approaches to causality\n\n### David Hume\n\n\"All reasonings concerning matter of fact seem to be founded on the relation of cause and effect. By means of that relation alone we can go beyond the evidence of our memory and senses.\" ---David Hume, An Enquiry Concerning Human Understanding, 1777.\n\n\"Suppose a person, though endowed with the strongest faculties of reason and reflection, to be brought on a sudden into this world; he would, indeed, immediately observe a continual succession of objects, and one event following another; but he would not be able to discover anything farther. He would not, at first, by any reasoning, be able to reach the idea of cause and effect\" (section V, part I).\n\nSimilar reasoning was found by earlier philosophers, such as 11th century al Ghazali.\n\nHume believed that we perceive causality on the basis of experience, but causality cannot be proved by reason. He established 8 \"rules by which to judge of causes and effects\" (Treatise on Human Nature, book 1, part III, section 15):\n\n1.  Contiguous in space and time.\n\n2.  Temporality: cause comes before effect.\n\n3.  Perfect correlation: \"constant union betwixt the cause and effect\"\n\n4.  \"The same cause always produces the same effect, and the same effect never arises but from the same cause.\"\n\n5.  \"like effects imply like causes.\"\n\n6.  Failure of an expected event to occur \"proceeds from some difference in the causes\"\n\n7.  Dose-response: \"The absence or presence of one part of the cause is here supposed to be always attended with the absence or presence of a proportionable part of the effect.\" but \"A certain degree of heat gives pleasure; if you diminish that heat, the pleasure diminishes; but it does not follow, that if you augment it beyond a certain degree, the pleasure will likewise augment; for we find that it degenerates into pain.\"\n\n8.  Multiple causes: \"like effects necessarily follow from like causes, and in a contiguous time and place, their separation for a moment shows, that these causes are not complete ones.\" Hume comments on his rules for perceiving causality: \"Here is all the LOGIC I think proper to employ in my reasoning; and perhaps even this was not very necessary, but might have been supplied by the natural principles of our understanding. ... All the rules of this nature are very easy in their invention, but extremely difficult in their application.\"\n\nKant believed in causality because otherwise it wouldn't be possible to understand the world.\n\n## Epidemiologic approaches to causality\n\nCausal inference is the goal of epidemiologic studies.\n\n\"Correlation does not imply causation\" is a known clichee, but how far can you get with correlation?\n\n### Associations\n\n-   Children raised with more books in the house delay sex.\n\n-   As ice cream sales rise, the risk of drowning rises.\n\n-   As the number of pirates has decreased, the average global temperature has increased.\n\n-   People who consume beta carotene supplements have lower rates of cancer. Randomized controlled trials showed beta carotene treatment group had a small increase in lung cancer and mortality relative to the placebo control group.\n\n### Lack of association is meaningful.\n\n-   If lack of access to land caused scurvy, we would expect to see an association between recovery from scurvy and being buried in the ground, even in a non-randomized trial.\n\n-   If drowning was unrelated to alcohol, we would expect to see no correlation between rates of drowning and sales of alcohol.\n\n-   If comprehensive sex education increased teen pregnancy and sexually transmitted in- fections, we would expect that places with less comprehensive sex education would have lower teen pregnancy and STIs than the rest of the country.\n\n### Henle-Koch postulates (1890)\n\nRobert Koch and Friedrich Loeffler\n\n1.  The agent is present in every case of the disease, and not in healthy subjects.\n\n2.  The agent can be isolated and grown in pure culture.\n\n3.  The agent will cause the disease if introduced to healthy subjects.\n\n4.  The same organism must be reisolated from the experimentally infected host.\n\nUsing Koch's postulates, Koch's students identified the organisms responsible for diphtheria, typhoid, gonorrhea, pneumonia, meningitis, leprosy, bubonic plague, tetanus and syphilis. In 1984, Barry Marshall drank Helicobacter pylori to test his theory about gastritis, following Koch's third postulate.\n\nLimitations of Henle-Koch postulates\n\n-   Asymptomatic carriers of a disease agent: Koch discovered asymptomatic carriers of typhoid and cholera. Poliovirus causes paralytic disease in about 1% of those infected.\n\n-   Some disease agents can't be cultured: e.g., prions.\n\n-   Public health expanded to chronic diseases, injury prevention, and other non-infectious causes of morbidity and mortality.\n\n### Hill's criteria for observational data\n\nThe Surgeon General's report on smoking and 1965 paper by Sir Austin Bradford Hill advanced standards that could be used to judge when an association might be causal. Note: This list is not a checklist.\n\n1.  Strength: Stronger associations are more likely to be causal and less likely due to chance or confounding.\n\n2.  Consistency: Association has been observed by different persons, in different settings (places, circumstances, times), populations, and methods.\n\n3.  Specificity: single cause produces a specific effect.\n\n4.  Temporality: Exposure precedes outcome.\n\n5.  Biologic Gradient: dose-response relationship.\n\n6.  Plausibility of a mechanism between exposure and disease.\n\n7.  Coherence between epidemiologic theory and laboratory evidence.\n\n8.  Experiment: concurring experimental evidence exists.\n\n9.  Analogy to similar situations.\n\n### Koepsell and Weiss's causal criteria Summary of Hill's criteria\n\n1.  Temporality\n\n2.  Strong association\n\n3.  No plausible non-causal explanation accounts for entirety of the association, and a plausible explanation for the association being causal.\n\n4.  Magnitude of association is strongest when predicted to be so. Causality from potential outcomes: the Rubin Causal Model Epidemiologic research attempts to establish what would have happened in the absence of \"treatment.\"\n\n## Counterfactuals\n\n### Counterfactuals in the legal system.\n\nThe Federal Judicial Center's Reference Manual on Scientific Evidence (1994, Chapter 3, p. 481) states: \"The first step in a damages study is the translation of the legal theory of the harmful event into an analysis of the economic impact of that event. In most cases, the analysis considers the difference between the plaintiff's economic position if the harmful event had not occurred and the plaintiff's actual economic position. The damages study restates the plaintiff's position\"but for\" the harmful event; this part is often called the but-for analysis. Damages are the difference between the but-for value and the actual value.\" (Book available for free download here: https://nap.nationalacademies.org/read/13163/chapter/10)\n\n### Effect of aspirin on headaches with n=1\n\nDon Rubin gives the following example of a counter-factual: Say that you have a headache. You will measure your pain 2 hours after taking an aspirin versus not taking an aspirin. You can phrase the causal effect of the aspirin as follows.\n\nYou can express the headache pain with and without aspirin. The effect of aspirin on headache pain is -50 units of pain, comparing the headache pain without aspirin (75) versus with aspirin (25).\n\n| Unit | Headache pain with aspirin | Headache pain without aspirin | Causal effect |\n|:-------------|:--------------------|:----------------------|:-------------|\n| You  | 25                         | 75                            | -50           |\n\nYou can express the same quantities by how much headache pain changes under aspirin and no aspirin. Without aspirin, the pain reduces by 5 units. With aspirin, it reduces by 55 units. The effect of aspirin on headache pain is -50 units of pain.\n\n| Unit | Initial headache | Reduction in pain with aspirin | Reduction in pain without aspirin | Causal effect |\n|:------------|:------------|:---------------|:-----------------|:------------|\n| You  | 80               | -55                            | -5                                | -50           |\n\nIn real life, you never know what would have happened both with and without aspirin: one condition is always missing.\n\n### The perfect doctor\n\nThis example is also due to Don Rubin.\n\nImagine an omniscient doctor who could know the outcome of each patient under two different treatments.\n\nThe data given below shows all potential outcomes for the number of years lived under two different treatments: standard surgery and a new surgery.\n\n| Patient      | Standard surgery | New surgery | Causal effect (new-standard) |\n|:-------------|:-----------------|:------------|:-----------------------------|\n| A            | 13               | 14          | -1                           |\n| B            | 6                | 0           | 6                            |\n| C            | 4                | 1           | 3                            |\n| D            | 5                | 2           | 3                            |\n| E            | 6                | 3           | 3                            |\n| F            | 6                | 1           | 5                            |\n| G            | 8                | 10          | -2                           |\n| H            | 8                | 9           | -1                           |\n| True average | 7                | 5           | 2                            |\n\nWe can see from this omniscient standpoint that the true causal effect is that the standard surgery results in 2 more years of life on average than the new surgery. If we did a randomized experiment, we would expect that on average our results would show this.\n\nThe perfect doctor would choose the best treatment for the patient, and if there's no difference, she flips a coin.\n\nObserved outcomes under perfect doctor's assignment give the opposite of random assignment. The data therefore look like this:\n\n| Patient          | Standard surgery | New surgery | Treatment |\n|:-----------------|:-----------------|:------------|:----------|\n| A                | ?                | 14          | New       |\n| B                | 6                | ?           | Standard  |\n| C                | 4                | ?           | Standard  |\n| D                | 5                | ?           | Standard  |\n| E                | 6                | ?           | Standard  |\n| F                | 6                | ?           | Standard  |\n| G                | ?                | 10          | New       |\n| H                | ?                | 9           | New       |\n| Observed average | 5.4              | 11          |           |\n\nThe apparent causal effect is that the new surgery results in 5.6 more years of life than the standard surgery.\n\nRandom assignment on average yields the true averages. Across all possible assignments to standard versus new surgery (56 ways to assign 3 participants to get the new surgery and 5 participants to get the old surgery), we get an average treatment effect of -2 (standard surgery better than new surgery by 2 years).\n\n## Exercises\n\n### Whickham data\n\nThese data come from\n\nDR Appleton, JM French, MPJ Vanderpump. \"Ignoring a covariate: an example of Simpson's paradox\". (1996) American Statistician, 50(4):340-341.\n\nThese data are a random sample study in Whickham, UK of smoking among women in 1972-74 and viral status in 1992-94.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(mosaic)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRegistered S3 method overwritten by 'mosaic':\n  method                           from   \n  fortify.SpatialPolygonsDataFrame ggplot2\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nThe 'mosaic' package masks several functions from core packages in order to add \nadditional features.  The original behavior of these functions should not be affected by this.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'mosaic'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:dplyr':\n\n    count, do, tally\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:Matrix':\n\n    mean\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:ggplot2':\n\n    stat\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    binom.test, cor, cor.test, cov, fivenum, IQR, median, prop.test,\n    quantile, sd, t.test, var\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    max, mean, min, prod, range, sample, sum\n```\n:::\n\n```{.r .cell-code}\ntally(outcome ~ smoker, data=Whickham, margin=T)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       smoker\noutcome  No Yes\n  Alive 502 443\n  Dead  230 139\n  Total 732 582\n```\n:::\n:::\n\n\nCalculate the percentage of baseline current smokers versus baseline never-smokers who were still alive at the second survey (1992--94.) Interpret your results. Can you think of any explanation for these results?\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntally(outcome ~ smoker, data=Whickham, format=\"percent\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       smoker\noutcome       No      Yes\n  Alive 68.57923 76.11684\n  Dead  31.42077 23.88316\n```\n:::\n:::\n\n\nUse the data to evaluate whether age is a confounder of the relationship between smoking and mortality.\n\n### Perfect doctor continued\n\nThis Perfect Doctor problem is based on one from Don Rubin.\n\nSchizophrenia drugs are a big problem for state Medicaid budgets: need to test new drugs against old to see if the extra cost is worth it. From point of view of omniscient being, we have two drugs to compare. Outcome is quality of life, 0 to 100.\n\n| Patient | New drug | Old drug | Causal effect (new-old) |\n|:--------|:---------|:---------|:------------------------|\n| A       | 100      | 80       | 20                      |\n| B       | 100      | 80       | 20                      |\n| C       | 50       | 90       | -40                     |\n| D       | 40       | 90       | -50                     |\n\nCalculate the true average treatment effect (ATE) of the drug. Is the new drug better?\n\nPeople vary and the perfect doctor assigns each person to their optimal treatment. Calculate the treatment effect under the perfect doctor. Is the new drug better?\n\nThere are 4 choose 2 = 6 combinations of assignments of subjects to treatment or control, listed below: trial 1 through trial 6.\n\nWrite down all possible treatment effects under each assignment. Make a histogram of the average treatment effect (ATE).\n\n| Patient          | 1   | 2   | 3   | 4   | 5   | 6   |\n|:-----------------|:----|:----|:----|:----|:----|:----|\n| A                | New | New | Old | Old | New | Old |\n| B                | New | Old | New | Old | Old | New |\n| C                | Old | New | Old | New | Old | New |\n| D                | Old | Old | New | New | New | Old |\n| Treatment effect |     |     |     |     |     |     |\n\nLocate your answers to part a and b on the histogram. Comment on the role of randomized treatment assignment in causal inference.\n\nIn the real world, people drop out: 75% of people in the Sept 2005 NEJM study that this problem is based on dropped out. Who is most likely to drop out of the study? How will the drop out affect treatment effects? How do you compensate for the drop out?\n\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}